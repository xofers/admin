<extend name="Public:base" />

<block name="style">
<link rel="stylesheet" type="text/css" href="__SCRIPTS__/metroinc/css/plugins.css"/>
<link rel="stylesheet" type="text/css" href="__SCRIPTS__/metroinc/plugins/bootstrap-select/bootstrap-select.min.css"/>
<style>
	textarea{
		resize: none;	
	}
</style>
</block>

<block name="header">
	<include file="Public:header" />
</block>

<block name="left">
	<include file="Public:left" />
</block>

<block name="address">
	<include file="Public:address" />
</block>

<block name="content">
	<div class="row">
		<div class="col-md-12">
			<div class="tabbable tabbable-custom boxless tabbable-reversed" style="overflow: visible;">
				<ul class="nav nav-tabs">
					<li class="active"><a href="javascript:;">基础</a></li>
					<li><a href="javascript:;">高级</a></li>
				</ul>
				<div class="tab-content">
					<form action="{:U('update')}" method="post" class="horizontal-form doc-modal-form">
						<div class="tab-pane active">
							<div class="row">
								<div class="col-md-6">
									<div class="form-group">
										<label class="control-label">字段名<span class="check-tips">（请输入字段名 英文字母开头，长度不超过30）</span></label>
										<input type="text" class="form-control input-xlarge" name="name" value="{$info.name}">
									</div>
								</div>
								<div class="col-md-6">
									<div class="form-group">
										<label class="control-label">字段类型<span class="check-tips">（用于表单中的展示方式）</span></label>
										<div class="controls">
											<select name="type"  id="data-type" style="display: none;" class="bs-select form-control input-small" data-style="blue">
												<option value="">----请选择----</option>
												<volist name=":get_attribute_type()" id="type">
												<option value="{$key}" rule="{$type[1]}">{$type[0]}</option>
												</volist>
											</select>
										</div>
									</div>
								</div>
								<div class="col-md-6">
									<div class="form-group">
										<label class="control-label">字段标题<span class="check-tips">（请输入字段标题，用于表单显示）</span></label>
										<input type="text" class="form-control input-xlarge" name="title" value="{$info.title}">
									</div>
								</div>
								<div class="col-md-6">
									<div class="form-group">
										<label class="control-label">字段定义<span class="check-tips">（字段属性的sql表示）</span></label>
										<input type="text" class="form-control input-xlarge" name="field" value="{$info.field}"  id="data-field">
									</div>
								</div>
								<div class="col-md-6">
									<div class="form-group">
										<label class="control-label">参数<span class="check-tips">（布尔、枚举、多选字段类型的定义数据）</span></label>
										<textarea type="text" class="form-control" name="extra" value="{$info.extra}"></textarea> 
									</div>
								</div>
								<div class="col-md-6">
									<div class="form-group">
										<label class="control-label">默认值<span class="check-tips">（字段的默认值）</span></label>
										<input type="text" class="form-control input-xlarge" name="value" value="{$info.value}">
									</div>
								</div>
								<div class="col-md-6">
									<div class="form-group">
										<label class="control-label">字段备注<span class="check-tips">（用于表单中的提示）</span></label>
										<input type="text" class="form-control input-xlarge" name="remark" value="{$info.remark}">
									</div>
								</div>
								<div class="col-md-6">
									<div class="form-group">
										<label class="control-label">是否显示<span class="check-tips">（是否显示在表单中）</span></label>
										<div class="controls">
											<select name="is_show" style="display: none;" class="bs-select form-control input-small" data-style="blue">
												<option value="1">始终显示</option>
												<option value="2">新增显示</option>
												<option value="3">编辑显示</option>
												<option value="0">不显示</option>
											</select>
										</div>
									</div>
								</div>
								<div class="col-md-6">
									<div class="form-group">
										<label class="control-label">是否必填<span class="check-tips">（用于自动验证）</span></label>
										<div class="controls">
											<select name="is_must" style="display: none;" class="bs-select form-control input-small" data-style="blue">
												<option value="0">否</option>
												<option value="1">是</option>
											</select>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="tab-pane hidden">
							<div class="row">
								<div class="col-md-6">
									<div class="form-group">
										<label class="control-label">验证方式<span class="check-tips"></span></label>
										<div class="controls">
											<select name="validate_type" style="display: none;" class="bs-select form-control input-small" data-style="blue">
												<option value="regex">正则验证</option>
												<option value="function">函数验证</option>
												<option value="unique">唯一验证</option>
												<option value="length">长度验证</option>
				                                <option value="in">验证在范围内</option>
				                                <option value="notin">验证不在范围内</option>
				                                <option value="between">区间验证</option>
				                                <option value="notbetween">不在区间验证</option>
											</select>
										</div>
									</div>
								</div>
								<div class="col-md-6">
									<div class="form-group">
										<label class="control-label">验证时间<span class="check-tips"></span></label>
										<div class="controls">
											<select name="validate_time" style="display: none;" class="bs-select form-control input-small" data-style="blue">
												<option value="3">始终</option>
												<option value="1">新增</option>
												<option value="2">编辑</option>
											</select>
										</div>
									</div>
								</div>
								<div class="col-md-6">
									<div class="form-group">
										<label class="control-label">自动完成方式<span class="check-tips"></span></label>
										<div class="controls">
											<select name="auto_type" style="display: none;" class="bs-select form-control input-small" data-style="blue">
												<option value="function">函数</option>
												<option value="field">字段</option>
												<option value="string">字符串</option>
											</select>
										</div>
									</div>
								</div>
								<div class="col-md-6">
									<div class="form-group">
										<label class="control-label">自动完成时间<span class="check-tips">（默认列表模板的分页属性）</span></label>
										<div class="control">
											<select name="auto_time" style="display: none;" class="bs-select form-control input-small" data-style="blue">
												<option value="3">始终</option>
												<option value="1">新增</option>
												<option value="2">编辑</option>
											</select>
										</div>
									</div>
								</div>
								<div class="col-md-6">
									<div class="form-group">
										<label class="control-label">验证规则<span class="check-tips">（根据验证方式定义相关验证规则）</span></label>
										<div class="control">
											<input type="text" class="form-control" name="validate_rule" value="{$info.validate_rule}">
										</div>
									</div>
								</div>
								<div class="col-md-6">
									<div class="form-group">
										<label class="control-label">出错提示<span class="check-tips"></span></label>
										<div class="control">
											<input type="text" class="form-control" name="error_info" value="{$info.error_info}">
										</div>
									</div>
								</div>
								
								<div class="col-md-6">
									<div class="form-group">
										<label class="control-label">自动完成规则<span class="check-tips">（根据完成方式订阅相关规则）</span></label>
										<div class="control">
											<input type="text" class="form-control" name="auto_rule" value="{$info.auto_rule}">
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="form-group">
							<input type="hidden" name="id" value="{$info['id']}"/>
							<input type="hidden" name="model_id" value="{$info['model_id']}"/>
							<button type="submit" class="btn green ajax-post" target-form="horizontal-form">确 定</button>
							<button class="btn blue" onclick="javascript:history.back(-1);return false;">返 回</button>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>
</block>

<block name="script">
<script type="text/javascript" src="__SCRIPTS__/metroinc/plugins/bootstrap-select/bootstrap-select.min.js"></script>
<script type="text/javascript" src="__SCRIPTS__/metroinc/scripts/custom/bootstrapSelect.js"></script>
<script>
highlight_subnav('{:U("Model/index")}');
Index.setValue('type', "{$info.type|default=''}");
Index.setValue('is_show', "{$info.is_show|default=1}");
Index.setValue('is_must', "{$info.is_must|default=0}");
Index.setValue('validate_time', "{$info.validate_time|default=3}");
Index.setValue('auto_time', "{$info.auto_time|default=3}");
Index.setValue('validate_type', "{$info.validate_type|default='regex'}");
Index.setValue('auto_type', "{$info.auto_type|default='function'}");
$(function(){
	<eq name="ACTION_NAME" value="add">
		$('#data-type').on("change",function(){
			$('#data-field').val($(this).find('option:selected').attr('rule'));
		});
	</eq>
	BootstrapSelect.init();
})
$("ul.nav li a").click(function(){
	$(this).parents("li").siblings().removeClass("active");
	$(this).parents("li").addClass("active");
	$(".tab-content .tab-pane.active").removeClass("active").addClass("hidden");
	$(".tab-content .tab-pane").eq($(this).parents("li").index()).removeClass("hidden").addClass("active");
})
</script>
</block>